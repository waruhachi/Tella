(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5179:(e,t,a)=>{Promise.resolve().then(a.bind(a,2969))},2969:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(5155),l=a(2115),i=a(5942),r=a(319),n=a(5564),o=a(1567);let d=l.forwardRef((e,t)=>{let{className:a,type:l,...i}=e;return(0,s.jsx)("input",{type:l,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});d.displayName="Input";var c=a(2317);let f=(0,a(1027).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=l.forwardRef((e,t)=>{let{className:a,variant:l,size:i,asChild:r=!1,...n}=e,d=r?c.DX:"button";return(0,s.jsx)(d,{className:(0,o.cn)(f({variant:l,size:i,className:a})),ref:t,...n})});u.displayName="Button";var m=a(4314);let p=m.bL;m.l9;let h=m.ZL,x=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(m.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});x.displayName=m.hJ.displayName;let b=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(h,{children:[(0,s.jsx)(x,{}),(0,s.jsx)(m.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});b.displayName=m.UC.displayName;let g=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};g.displayName="AlertDialogHeader";let y=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};y.displayName="AlertDialogFooter";let N=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(m.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold",a),...l})});N.displayName=m.hE.displayName;let v=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(m.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...l})});v.displayName=m.VY.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(m.rc,{ref:t,className:(0,o.cn)(f(),a),...l})});j.displayName=m.rc.displayName;let w=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(m.ZD,{ref:t,className:(0,o.cn)(f({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});function S(){let{toast:e}=(0,n.dj)(),[t,a]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),[f,m]=(0,l.useState)(null),[h,x]=(0,l.useState)(null),[S,T]=(0,l.useState)({title:"",description:""}),O=async function(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a instanceof FormData?s:{"Content-Type":"application/json",...s},i=await fetch(e,{method:t,body:a,headers:l}),r=await i.json();if(!i.ok)throw Error(r.details||r.error||"Unknown error");return r},k=async()=>{if(h&&!t){a(!0);try{let e=await O("/check","POST",JSON.stringify({fileName:h.name}));if(e.exists){let t=await fetch(e.filePath).then(e=>e.blob());T({title:"Patch Already Exists",description:"A patched version of this file already exists.",fileName:h.name.replace(".ipa","_Patched.ipa"),fileSize:"".concat((t.size/1024/1024).toFixed(2)," MB"),fileBlob:t}),c(!0),a(!1);return}let t=null!=f?f:crypto.randomUUID();m(t);let s=Math.ceil(h.size/2097152);for(let e=0;e<s;e++){let a=h.slice(2097152*e,(e+1)*2097152),l=new FormData;l.append("file",a),l.append("fileID",t),l.append("chunkIndex",e.toString()),l.append("totalChunks",s.toString()),await O("/chunk","POST",l)}let l=await O("/merge","POST",JSON.stringify({fileID:f,fileName:h.name}));if(!l.filePath)throw Error("Merge response did not include file path");let i=await O("/patch","POST",JSON.stringify({filePath:l.filePath})),r=await fetch(i.filePath).then(e=>e.blob());T({title:"Patch Successful",description:"Your file has been patched successfully.",fileName:i.fileName,fileSize:"".concat((r.size/1024/1024).toFixed(2)," MB"),fileBlob:r}),c(!0)}catch(e){T({title:"Error",description:e instanceof Error?e.message:"Upload failed"}),c(!0)}finally{a(!1),x(null),m(null)}}},A=async()=>{if(S.fileBlob&&S.fileName){let t=URL.createObjectURL(S.fileBlob),a=document.createElement("a");a.href=t,a.download=S.fileName,document.body.appendChild(a),a.click(),URL.revokeObjectURL(t),document.body.removeChild(a),x(null),c(!1),e({title:"IPA Downloading",description:"IPA will be deleted in 2 minutes"}),setTimeout(async()=>{(await fetch("/clean",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:S.fileName})})).ok?e({title:"Cleanup Successful"}):e({variant:"destructive",title:"Cleanup failed"})},12e4)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"w-[400px] mx-auto p-10 bg-white shadow-2xl rounded-2xl",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-8",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(d,{type:"file",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&(e.target.value="",x(s),m(crypto.randomUUID()),a(!1),T({title:"",description:"",fileName:"",fileSize:"",fileBlob:null}),c(!1))},className:"hidden",id:"file-upload",accept:".ipa"}),(0,s.jsxs)("label",{htmlFor:"file-upload",className:"flex items-center justify-center w-full p-8 border-2 border-dashed border-gray-300 rounded-2xl cursor-pointer hover:border-blue-500 transition text-xl",children:[(0,s.jsx)(i.A,{className:"mr-4 h-8 w-8"}),(0,s.jsx)("span",{children:h?h.name:"Choose a file"})]})]}),(0,s.jsx)(u,{onClick:k,disabled:!h||t,className:"w-full text-xl py-4",children:t?(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),(0,s.jsx)("span",{className:"ml-2",children:"Uploading..."})]}):"Upload File"})]})})}),(0,s.jsx)(p,{open:o,onOpenChange:c,children:(0,s.jsxs)(b,{children:[(0,s.jsxs)(g,{children:[(0,s.jsx)(N,{children:S.title}),(0,s.jsxs)(v,{children:[S.description,S.fileName&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"mt-4 block",children:[(0,s.jsx)("strong",{children:"File Name:"})," ",S.fileName]}),(0,s.jsxs)("span",{className:"block",children:[(0,s.jsx)("strong",{children:"File Size:"})," ",S.fileSize]})]})]})]}),(0,s.jsxs)(y,{children:[(0,s.jsx)(w,{onClick:()=>{x(null),c(!1)},children:"Cancel"}),S.fileBlob&&(0,s.jsxs)(j,{onClick:A,children:[(0,s.jsx)(r.A,{className:"mr-2 h-4 w-4"}),"Download"]})]})]})})]})}w.displayName=m.ZD.displayName},5564:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var s=a(2115);let l=0,i=new Map,r=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=n(d,e),o.forEach(e=>{e(d)})}function f(e){let{...t}=e,a=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=s.useState(d);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:f,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},1567:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(3463),l=a(9795);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[979,213,441,517,358],()=>t(5179)),_N_E=e.O()}]);